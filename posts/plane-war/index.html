<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="Asia/Jinan"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="飞机大战" /><meta name="author" content="Aye486" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="一、设计选题" /><meta property="og:description" content="一、设计选题" /><link rel="canonical" href="/posts/plane-war/" /><meta property="og:url" content="/posts/plane-war/" /><meta property="og:site_name" content="Aye486" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-15T02:48:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="飞机大战" /><meta name="twitter:site" content="@Aye486" /><meta name="twitter:creator" content="@Aye486" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Aye486"},"dateModified":"2022-06-25T14:28:24+00:00","datePublished":"2022-04-15T02:48:00+00:00","description":"一、设计选题","headline":"飞机大战","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/plane-war/"},"url":"/posts/plane-war/"}</script><title>飞机大战 | Aye486</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Aye486"><meta name="application-name" content="Aye486"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/config/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Aye486</a></div><div class="site-subtitle font-italic">这里是Aye486的博客～</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Aye486" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Aye486" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cwy1143','163.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>飞机大战</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>飞机大战</h1><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1649990880" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-04-15 </em> </span> <span> 更新于 <em class="" data-ts="1656167304" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-06-25 </em> </span><div class="d-flex justify-content-between"> <span> 作者 <em> Aye486 </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2274 字"> <em>12 分钟</em>阅读</span></div></div></div><div class="post-content"><h2 id="一设计选题"><span class="mr-2"><strong>一、设计选题</strong></span><a href="#一设计选题" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>《飞机大战》</strong></p><h2 id="二课题简介"><span class="mr-2"><strong>二、课题简介</strong></span><a href="#二课题简介" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>飞机大战是由腾讯公司的微信团队开发的一款微信小游戏，这款游戏以太空主题的画面为游戏背景，由玩家控制飞机，发射炮弹击毁敌方飞机。画面简洁有趣，规则简单易懂，操作便捷易上手。这款游戏不同于腾讯开发的以盈利为目标的其他游戏，抛去了现在游戏的花里胡哨，回归了游戏最简单的目的，仅仅是为了好玩，没有门槛，没有引导用户充钱。让我们们都能够找到童年玩掌机类游戏的乐趣。不过可惜《飞机大战》已经被淘汰，所以在这重现飞机大战，表达对现在国内缺乏真正让人快乐的游戏的惋惜和对这款经典游戏的致敬。并且希望国内的游戏市场能够变得更好，也能让更多的人可以改变对游戏的偏见，让大家能够真正感受到这第九大艺术的魅力。</strong></p><h2 id="三运行环境"><span class="mr-2"><strong>三、运行环境</strong></span><a href="#三运行环境" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Windows系统，PyCharm</strong></p><p><strong>Pygame,random,os</strong></p><hr /><h2 id="四具体实现"><span class="mr-2"><strong>四、具体实现</strong></span><a href="#四具体实现" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="1-架构设计"><span class="mr-2"><strong>1.</strong> <strong>架构设计</strong></span><a href="#1-架构设计" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>系统架构如图1所示。</p><p><img data-src="/assets/blog_res/2022-04-15-plane-war.assets/Snipaste_2022-04-15_11-11-40-16499923143602.png" alt="Snipaste_2022-04-15_11-11-40" data-proofer-ignore></p><p>下面分别介绍各个部分的作用及功能：</p><p>game.py，游戏主模块，封装Game类并负责启动游戏。</p><p>game_hud.py，游戏面板模块，封装指示器面板类。</p><p>game_items.py，游戏元素模块，封装英雄飞机，子弹，敌机，道具等游戏元素类，并定义全局变量。</p><p>game_music.py，游戏音乐模块，封装音乐播放器类。</p><p>font，放置游戏中使用的字体素材。</p><p>images，放置了游戏中使用的图片素材。</p><p>sound，放置了游戏中使用的声音素材。</p><h3 id="2-核心功能实现"><span class="mr-2"><strong>2.</strong> <strong>核心功能实现</strong></span><a href="#2-核心功能实现" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Game</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># 游戏类
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 游戏主窗口
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">main_window</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">SCREEN_RECT</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">pygame</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s">"飞机大战"</span><span class="p">)</span>
        <span class="c1"># 游戏状态
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">is_game_over</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">is_pause</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c1"># 精灵组属性
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">Group</span><span class="p">()</span>      <span class="c1"># 所有精灵组
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">Group</span><span class="p">()</span>  <span class="c1"># 敌机精灵组
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">supplies_group</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">Group</span><span class="p">()</span>   <span class="c1"># 道具精灵组
</span>        <span class="c1"># 创建精灵
</span>        <span class="c1"># 背景精灵，交替滚动
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Background</span><span class="p">(</span><span class="bp">False</span><span class="p">),</span> <span class="n">Background</span><span class="p">(</span><span class="bp">True</span><span class="p">))</span>
        <span class="c1"># 指示器面板
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span> <span class="o">=</span> <span class="n">HudPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
        <span class="c1"># 创建敌机
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">create_enemies</span><span class="p">()</span>
        <span class="c1"># 英雄精灵
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">hero</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
        <span class="c1"># 设置面板中炸弹数量
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">show_bomb</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span><span class="p">)</span>
        <span class="c1"># 创建道具
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">create_supplies</span><span class="p">()</span>
        <span class="c1"># 创建音乐播放器
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">player</span> <span class="o">=</span> <span class="n">MusicPlayer</span><span class="p">(</span><span class="s">"game_music.wav"</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_music</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">reset_game</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 重置游戏
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">is_game_over</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">is_pause</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">reset_panel</span><span class="p">()</span>
        <span class="c1"># 设置英雄的初始位置
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">midbottom</span> <span class="o">=</span> <span class="n">HERO_DEFAULT_MID_BOTTOM</span>
        <span class="c1"># 清空所有敌机
</span>        <span class="k">for</span> <span class="n">enemy</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">:</span>
            <span class="n">enemy</span><span class="p">.</span><span class="n">kill</span><span class="p">()</span>
        <span class="c1"># 清空残留子弹
</span>        <span class="k">for</span> <span class="n">bullet</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bullets_group</span><span class="p">:</span>
            <span class="n">bullet</span><span class="p">.</span><span class="n">kill</span><span class="p">()</span>
        <span class="c1"># 重新创建敌机
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">create_enemies</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">event_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 监听事件：return：如果监听到退出事件，返回True，否则给、返回False
</span>        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="p">.</span><span class="n">event</span><span class="p">.</span><span class="n">get</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">QUIT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>

            <span class="k">elif</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">KEYDOWN</span> <span class="ow">and</span> <span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">K_ESCAPE</span> <span class="ow">or</span> <span class="n">event</span><span class="p">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">K_SPACE</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">is_game_over</span><span class="p">:</span>              <span class="c1"># 游戏已经结束
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">reset_game</span><span class="p">()</span>              <span class="c1"># 重新开始游戏
</span>                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">is_pause</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">is_pause</span>   <span class="c1"># 切换暂停状态
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">pause_music</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">is_pause</span><span class="p">)</span>
            <span class="s">"""以下为开发者按钮"""</span>
            <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">KEYDOWN</span> <span class="ow">and</span> <span class="n">event</span><span class="p">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">K_l</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">lives_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">show_lives</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">KEYDOWN</span> <span class="ow">and</span> <span class="n">event</span><span class="p">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">K_i</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">is_power</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">is_power</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">is_power</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">elif</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">KEYDOWN</span> <span class="ow">and</span> <span class="n">event</span><span class="p">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">K_a</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">show_bomb</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">KEYDOWN</span> <span class="ow">and</span> <span class="n">event</span><span class="p">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">K_n</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bullets_kind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bullets_kind</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bullets_kind</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="s">"""结束"""</span>
            <span class="c1"># 判断是否正在游戏
</span>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">is_game_over</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">is_pause</span><span class="p">:</span>
                <span class="c1"># 监听发射子弹事件
</span>                <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span><span class="n">HERO_FIRE_EVENT</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s">"bullet.wav"</span><span class="p">)</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">fire</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
                <span class="c1"># 监听关闭子弹增强事件
</span>                <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">BULLET_ENHANCED_OFF_EVENT</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bullets_kind</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">pygame</span><span class="p">.</span><span class="n">time</span><span class="p">.</span><span class="n">set_timer</span><span class="p">(</span><span class="n">BULLET_ENHANCED_OFF_EVENT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="c1"># 监听投放道具事件
</span>                <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">THROW_SUPPLY_EVENT</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s">"supply.wav"</span><span class="p">)</span>
                    <span class="n">supply</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">supplies_group</span><span class="p">.</span><span class="n">sprites</span><span class="p">())</span>
                    <span class="n">supply</span><span class="p">.</span><span class="n">throw_supply</span><span class="p">()</span>
                <span class="c1"># 监听英雄牺牲事件
</span>                <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">HERO_DEAD_EVENT</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"英雄牺牲了..."</span><span class="p">)</span>

                    <span class="c1"># 生命计数 -1
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">lives_count</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="c1"># 更新生命计数显示
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">show_lives</span><span class="p">()</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">lives_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># 设置英雄回到的初始位置
</span>                        <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">midbottom</span> <span class="o">=</span> <span class="n">HERO_DEFAULT_MID_BOTTOM</span>
                        <span class="c1"># 开启无敌模式
</span>                        <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">is_power</span> <span class="o">=</span> <span class="bp">True</span>

                    
                    <span class="c1"># 更新炸弹显示
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">show_bomb</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span><span class="p">)</span>

                    <span class="c1"># 监听取消英雄无敌事件
</span>                <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">HERO_POWER_OFF_EVENT</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"取消无敌状态..."</span><span class="p">)</span>
                    <span class="c1"># 设置英雄属性
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">is_power</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="c1"># 取消定时器
</span>                    <span class="n">pygame</span><span class="p">.</span><span class="n">time</span><span class="p">.</span><span class="n">set_timer</span><span class="p">(</span><span class="n">HERO_POWER_OFF_EVENT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="c1"># 监听玩家按下b，引爆一颗炸弹
</span>
                <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">KEYDOWN</span> <span class="ow">and</span> <span class="n">event</span><span class="p">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="p">.</span><span class="n">K_b</span><span class="p">:</span>
                    <span class="c1"># 如果英雄没有牺牲同时有炸弹
</span>                    <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">hp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s">"use_bomb.wav"</span><span class="p">)</span>
                    <span class="c1"># 引爆炸弹
</span>                    <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">blowup</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">)</span>
                    <span class="c1"># 更新炸弹数量显示
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">show_bomb</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span><span class="p">)</span>
                    <span class="c1"># 更新游戏得分，如果游戏等级提升，创建新的敌机
</span>                    <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">increase_score</span><span class="p">(</span><span class="n">score</span><span class="p">):</span>
                        <span class="bp">self</span><span class="p">.</span><span class="n">create_enemies</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 开始游戏
</span>        <span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">time</span><span class="p">.</span><span class="n">Clock</span><span class="p">()</span>             <span class="c1"># 游戏时钟
</span>        <span class="n">frame_counter</span> <span class="o">=</span> <span class="mi">0</span>                       <span class="c1"># 逐帧动画计数器
</span>        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1"># 生命计数等于 0，表示游戏结束
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">is_game_over</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">lives_count</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">event_handler</span><span class="p">():</span>            <span class="c1"># 事件监听
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">save_best_score</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="c1"># 判断游戏状态
</span>            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">is_game_over</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">panel_pause</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="p">.</span><span class="n">is_pause</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">panel_pause</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 获得当前时刻的按键元组
</span>                <span class="n">keys</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">key</span><span class="p">.</span><span class="n">get_pressed</span><span class="p">()</span>
                <span class="c1"># 水平移动基数
</span>                <span class="n">move_hor</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="p">.</span><span class="n">K_RIGHT</span><span class="p">]</span> <span class="o">-</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="p">.</span><span class="n">K_LEFT</span><span class="p">]</span>
                <span class="c1"># 垂直移动基数
</span>                <span class="n">move_ver</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="p">.</span><span class="n">K_DOWN</span><span class="p">]</span> <span class="o">-</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="p">.</span><span class="n">K_UP</span><span class="p">]</span>
                <span class="c1"># 修改逐帧动画计数器
</span>                <span class="n">frame_counter</span> <span class="o">=</span> <span class="p">(</span><span class="n">frame_counter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">FRAME_INTERVAL</span>
                <span class="c1"># 更新 all_group 中所有精灵内容
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">frame_counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">move_hor</span><span class="p">,</span> <span class="n">move_ver</span><span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">panel_resume</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
                <span class="c1"># 碰撞检测
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">check_collide</span><span class="p">()</span>
            <span class="c1"># 绘制 all_group 中的所有精灵
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">main_window</span><span class="p">)</span>
            <span class="n">pygame</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">update</span><span class="p">()</span>             <span class="c1"># 更新显示
</span>            <span class="n">clock</span><span class="p">.</span><span class="n">tick</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>                      <span class="c1"># 设置刷新帧率
</span>            
    <span class="k">def</span> <span class="nf">create_enemies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 根据游戏级别创建不同数量的敌机
</span>        <span class="c1"># 敌机精灵组中的精灵数量
</span>        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">.</span><span class="n">sprites</span><span class="p">())</span>
        <span class="c1"># 要添加到的精灵组
</span>        <span class="n">groups</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">)</span>
        <span class="c1"># 判断游戏级别及已有的敌机数量
</span>        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>        <span class="c1"># 关卡 1
</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
                <span class="n">Enemy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">*</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>     <span class="c1"># 关卡 2
</span>            <span class="c1"># 增加敌机的最大速度
</span>            <span class="k">for</span> <span class="n">enemy</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">.</span><span class="n">sprites</span><span class="p">():</span>
                <span class="n">enemy</span><span class="p">.</span><span class="n">max_speed</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="c1"># 创建敌机
</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
                <span class="n">Enemy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">*</span><span class="n">groups</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">Enemy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">26</span><span class="p">:</span>     <span class="c1"># 关卡 3
</span>            <span class="c1"># 增加敌机的最大速度
</span>            <span class="k">for</span> <span class="n">enemy</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">.</span><span class="n">sprites</span><span class="p">():</span>
                <span class="n">enemy</span><span class="p">.</span><span class="n">max_speed</span> <span class="o">=</span> <span class="mi">7</span> <span class="k">if</span> <span class="n">enemy</span><span class="p">.</span><span class="n">kind</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">3</span>
            <span class="c1"># 创建敌机
</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
                <span class="n">Enemy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">*</span><span class="n">groups</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">Enemy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">*</span><span class="n">groups</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">Enemy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">groups</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_collide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""碰撞检测"""</span>
        <span class="c1"># 检测英雄飞机和敌机的碰撞
</span>        <span class="n">collide_enemies</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span>
                                                      <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">collide_mask</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">is_power</span><span class="p">:</span>
            <span class="n">enemies</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span>
                                                      <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">collide_mask</span><span class="p">)</span>
            <span class="n">enemies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">hp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span><span class="n">enemies</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">enemies</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">wav_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">hp</span> <span class="o">=</span> <span class="mi">0</span>
                
            <span class="k">for</span> <span class="n">enemy</span> <span class="ow">in</span> <span class="n">collide_enemies</span><span class="p">:</span>
                <span class="n">enemy</span><span class="p">.</span><span class="n">hp</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 摧毁发生碰撞的敌机
</span>                <span class="c1"># 检测敌机被子弹击中
</span>        <span class="n">hit_enemies</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">enemies_group</span><span class="p">,</span>
                                                     <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bullets_group</span><span class="p">,</span>
                                                     <span class="bp">False</span><span class="p">,</span>
                                                     <span class="bp">False</span><span class="p">,</span>
                                                     <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">collide_mask</span><span class="p">)</span>
        <span class="c1"># 遍历字典
</span>        <span class="k">for</span> <span class="n">enemy</span> <span class="ow">in</span> <span class="n">hit_enemies</span><span class="p">:</span>
            <span class="c1"># 已经被摧毁的敌机不需要浪费子弹
</span>            <span class="k">if</span> <span class="n">enemy</span><span class="p">.</span><span class="n">hp</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># 遍历击中敌机的子弹列表
</span>            <span class="k">for</span> <span class="n">bullet</span> <span class="ow">in</span> <span class="n">hit_enemies</span><span class="p">[</span><span class="n">enemy</span><span class="p">]:</span>
                <span class="c1">#  将子弹从所有精灵组中清除
</span>                <span class="n">bullet</span><span class="p">.</span><span class="n">kill</span><span class="p">()</span>
                <span class="c1"># 修改敌机的生命值
</span>                <span class="n">enemy</span><span class="p">.</span><span class="n">hp</span> <span class="o">-=</span> <span class="n">bullet</span><span class="p">.</span><span class="n">damage</span>
                <span class="c1"># 如果敌机没有被摧毁，继续下一颗子弹
</span>                <span class="k">if</span> <span class="n">enemy</span><span class="p">.</span><span class="n">hp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># 修改游戏得分并判断是否升级
</span>                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">increase_score</span><span class="p">(</span><span class="n">enemy</span><span class="p">.</span><span class="n">value</span><span class="p">):</span>
                    <span class="c1"># 播放升级音效
</span>                    <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s">"upgrade.wav"</span><span class="p">)</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">create_enemies</span><span class="p">()</span>
                <span class="c1"># 播放敌机炸弹音效
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_sound</span><span class="p">(</span><span class="n">enemy</span><span class="p">.</span><span class="n">wav_name</span><span class="p">)</span>
                <span class="c1"># 退出遍历子弹列表循环
</span>                <span class="k">break</span>
        <span class="c1">#  英雄拾取道具
</span>        <span class="n">supplies</span> <span class="o">=</span> <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="p">.</span><span class="n">supplies_group</span><span class="p">,</span>
                                                <span class="bp">False</span><span class="p">,</span>
                                                <span class="n">pygame</span><span class="p">.</span><span class="n">sprite</span><span class="p">.</span><span class="n">collide_mask</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">supplies</span><span class="p">:</span>
            <span class="n">supply</span> <span class="o">=</span> <span class="n">supplies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># 播放使用道具音效
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">play_sound</span><span class="p">(</span><span class="n">supply</span><span class="p">.</span><span class="n">wav_name</span><span class="p">)</span>
            <span class="c1"># 将道具设置到游戏窗口下方
</span>            <span class="n">supply</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">SCREEN_RECT</span><span class="p">.</span><span class="n">h</span>
            <span class="c1"># 判断道具类型
</span>            <span class="k">if</span> <span class="n">supply</span><span class="p">.</span><span class="n">kind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 炸弹补给
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hud_panel</span><span class="p">.</span><span class="n">show_bomb</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bomb_count</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># 设置子弹增强
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">hero</span><span class="p">.</span><span class="n">bullets_kind</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># 设置关闭子弹增强的定时器事件
</span>                <span class="n">pygame</span><span class="p">.</span><span class="n">time</span><span class="p">.</span><span class="n">set_timer</span><span class="p">(</span><span class="n">BULLET_ENHANCED_OFF_EVENT</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_supplies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""创建道具"""</span>
        <span class="n">Supply</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">supplies_group</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
        <span class="n">Supply</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">supplies_group</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">all_group</span><span class="p">)</span>
        <span class="c1"># 设置 30s 投放道具定时器事件
</span>        <span class="n">pygame</span><span class="p">.</span><span class="n">time</span><span class="p">.</span><span class="n">set_timer</span><span class="p">(</span><span class="n">THROW_SUPPLY_EVENT</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">pygame</span><span class="p">.</span><span class="n">init</span><span class="p">()</span>
    <span class="n">Game</span><span class="p">().</span><span class="n">start</span><span class="p">()</span>
    <span class="n">pygame</span><span class="p">.</span><span class="n">quit</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="五项目演示"><span class="mr-2"><strong>五.项目演示</strong></span><a href="#五项目演示" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/assets/blog_res/2022-04-15-plane-war.assets/Snipaste_2022-04-15_11-14-42-16499925492993-16499925512894.png" alt="Snipaste_2022-04-15_11-14-42" data-proofer-ignore></p><p><img data-src="/assets/blog_res/2022-04-15-plane-war.assets/Snipaste_2022-04-15_11-14-51-16499925606355.png" alt="Snipaste_2022-04-15_11-14-51" data-proofer-ignore></p><p><img data-src="/assets/blog_res/2022-04-15-plane-war.assets/Snipaste_2022-04-15_11-15-00-16499925801867-16499925813478.png" alt="Snipaste_2022-04-15_11-15-00" data-proofer-ignore></p><p><img data-src="/assets/blog_res/2022-04-15-plane-war.assets/Snipaste_2022-04-15_11-15-09-16499925879989.png" alt="Snipaste_2022-04-15_11-15-09" data-proofer-ignore></p><h2 id="六心得体会"><span class="mr-2"><strong>六、心得体会</strong></span><a href="#六心得体会" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Python的计算生态很强大，通过pygame可以很轻松的设计出一款2D游戏，通过此次课程设计，我初步理解了面向对象的思想，感受到了使用python语言进行游戏项目开发的乐趣。当游戏能够运行时，心中便会有一种成就感。希望以后可以灵活的掌握运用面向对象的编程技巧，并且能将其运用到python程序的实际开发中。</p><p>源码资源可在这找到：</p><p>https://github.com/Aye486/scaling-adventure.git</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%E8%AF%BE%E8%AE%BE/'>课设</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/game/" class="post-tag no-text-decoration" >Game</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%E9%A3%9E%E6%9C%BA%E5%A4%A7%E6%88%98+-+Aye486&url=%2Fposts%2Fplane-war%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%E9%A3%9E%E6%9C%BA%E5%A4%A7%E6%88%98+-+Aye486&u=%2Fposts%2Fplane-war%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fplane-war%2F&text=%E9%A3%9E%E6%9C%BA%E5%A4%A7%E6%88%98+-+Aye486" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/plane-war/">飞机大战</a><li><a href="/posts/hello-world/">你好，世界！</a><li><a href="/posts/%E5%8D%8F%E7%A8%8B%E5%92%8Clibco/">协程简介</a><li><a href="/posts/client/">JAVA-Socket通信 聊天室（客户端）</a><li><a href="/posts/Service/">JAVA-Socket通信 聊天室（服务端）</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/%E7%AE%97%E6%B3%95/">算法</a> <a class="post-tag" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a> <a class="post-tag" href="/tags/game/">Game</a> <a class="post-tag" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/common/"><div class="card-body"> <em class="small" data-ts="1655298120" data-df="YYYY-MM-DD" > 2022-06-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JAVA-Socket通信 聊天室（工具类）</h3><div class="text-muted small"><p> 关于聊天室中工具类部分 整体思路 把要传输的内容封装成了两个类 Response 和 Request，客户端向服务器发起请求，服务器向客户端回应，通过两个类中包含的请求类型来判断需要进行的操作，传输采用ObjectStream。仔细以看其实会发现，这两个类内容很相似。 Request 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ...</p></div></div></a></div><div class="card"> <a href="/posts/chartroom/"><div class="card-body"> <em class="small" data-ts="1655298120" data-df="YYYY-MM-DD" > 2022-06-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JAVA-Socket通信 聊天室</h3><div class="text-muted small"><p> 聊天室曾经盛行一时，今天我们就用简单的java代码来复刻他。 一、项目名称 聊天室 二、功能介绍 用Java图形用户界面编写聊天室服务器端和客户端， 支持多个客户端连接到一个服务器。每个客户端能够输入账号，包括注册功能。 可以实现群聊（聊天记录显示在所有客户端界面）。 完成好友列表在各个客户端上显示，包括头像和用户名。 ...</p></div></div></a></div><div class="card"> <a href="/posts/Service/"><div class="card-body"> <em class="small" data-ts="1655298120" data-df="YYYY-MM-DD" > 2022-06-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JAVA-Socket通信 聊天室（服务端）</h3><div class="text-muted small"><p> 关于聊天室中服务器部分 一个聊天室，我们可以将其分为服务端和客户端，而通信的简易过程如下图所示 对于服务器，我们需要做的是1、验证用户登陆信息。2、接收用户发送的信息并转发给目标用户 整体思路 Server端 UserService 用于用户账号管理，预先创建几个账号，然后存到文件中，每次服务器执行时，都会将文件中的账号信息读入，同时新创建的用户账号也会存入到文件中去。 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Search-and-Graph-Theory/" class="btn btn-outline-primary" prompt="上一篇"><p>搜索与图论模板</p></a> <a href="/posts/data-structure/" class="btn btn-outline-primary" prompt="下一篇"><p>数据结构模板</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Aye486">Aye486</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/%E7%AE%97%E6%B3%95/">算法</a> <a class="post-tag" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a> <a class="post-tag" href="/tags/game/">Game</a> <a class="post-tag" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a> <a class="post-tag" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"></p><button type="button" class="btn btn-primary" aria-label="Update"> </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/asia/jinan.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
