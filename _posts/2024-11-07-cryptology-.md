---
title: 现代密码学
date: 2024-11-07 10:34:00 +0800
categories: [笔记]
tags: [密码学]
pin: false
author: Aye486

toc: true
comments: true
typora-root-url: ../../Aye486.github.io
math: false
mermaid: true



---

# 现代密码学

[^《现代密码学》（第4版）]:杨波 编著，清华大学出版社

# 第一章	引言

## 1.1 信息安全面临的威胁

​	信息是一种以特殊的物质形态存在的实体。

> Longo（朗高）：信息反映了事物的形式、关系和差别。它包含在事物的差异中，而不在事物本身。
>
> Wienor（维纳）：信息是人们在适应外部世界和这种适应反作用于外部世界的过程中，与外部世界进行互相交换的内容的名称。
>
> Shannon（香农）：信息是用来减少随机不定性的东西。

​	对信息的操作主要有感知、提取、识别、传递、储存、变换、处理、检索、利用等。

​	信息通常以某种形式存于媒体物质之中，此时我们通常称之为数据。

​	信息的处理方法和设备可概括为3C，即：Computer + Communication + Control

### 1.1.1 安全威胁

​	人们对信息安全的认识随着网络的发展经历了以下一个由简单到复杂的过程。

​	20世纪70年代，主机时代的信息安全是面向单机的，由于早期的用户主要是军方，信息的保密性是安全的主要考虑。

​	20世纪80年代，微机和局域网的兴起带来了信息在微机间的传输和用户间的共享问题，丰富了信息安全的内涵，使人们认识到数据完整性、可用性的重要性。安全服务、安全机制等基本框架，成为信息安全的重要内容。

​	20世纪90年代，因特网爆炸性的发展把人类带进了一个新的生存空间。因特网具有高度分布、边界模糊、层次欠清、动态演化，而用户又在其中扮演主角的特点，如何处理好这一复杂而巨大系统的安全，成为信息安全的主要问题。

#### 安全的分类

1. 系统安全
2. 设备安全
3. 数据安全
4. 内容安全
5. 行为安全

#### 攻击的分类：

 	1.被动攻击

​	 2.主动攻击

![image-20241107205827166](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107205827166.png)

[^图1.1.1]: 攻击分方式特点

##### **被动攻击**

​	被动攻击即窃听，是对系统的保密性进行攻击如搭线窃听、对文件或程序的非法拷贝等，以获取他人的信息。

​	被动攻击又分为两类，一类是获取消息的内容，很容易理解；第二类是进行业务流分析，假如我们通过某种手段，比如加密，使得敌手从截获的消息无法得到消息的真实内容，然而敌手却有可能获得消息的格式、确定通信双方的位置和身份以及通信的次数和消息的长度。

​	被动攻击因不对消息做任何修改，因而是难以检测的，所以抗击这种攻击的重点在于预防而非检测。

**主动攻击**

​	这种攻击包括对数据流的某些篡改或产生某些假的数据流。主动攻击又可分为以下3类：

1. 中断：是对系统的可用性进行攻击，如破坏计算机硬件、网络或文件管理系统。
2. 篡改：是对系统的完整性进行攻击，如修改数据文件中的数据、替换某一程序使其执行不同的功能、修改网络中传送的消息内容等。
3. 伪造：是对系统的真实性进行攻击。如在网络中插入伪造的消息或在文件中插入伪造的记录。

### 1.1.2 入侵者和病毒

 	信息安全的人为威胁主要来自用户（恶意的或无恶意的）和恶意软件的非法侵入，入侵信息系统的用户也称为黑客，其目的是对计算机系统实施破坏，也可能是一个犯罪分子，其目的是非法窃取系统资源，对数据进行未授权的修改或破坏计算机系统。

![image-20241107210248497](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107210248497.png)

[^图1.1.2 ]:恶意程序分类图

 	恶意软件指病毒、蠕虫等恶意程序，分为两类，一类需要主程序，另一类不需要。前者是某个程序中的一段，不能独立于实际的应用程序或系统程序；后者是能被操作系统调度和运行的独立程序。

​	 对恶意软件也可根据其能否自我复制来进行分类。不能自我复制的是程序段，这种程序段在主程序被调用执行时就可激活。能够自我复制的或者是程序段（病毒）或者是独立的程序（蠕虫、细菌等），当这种程序段或独立的程序被执行时，可能复制一个或多个自己的副本，以后这些副本可在这一系统或其他系统中被激活。

### 1.1.3 安全业务

#### **保密业务**

 	保护数据以防被动攻击。保护方式可根据保护范围的大小分为若干级，其中最高级保护可在一定时间范围内保护两个用户之间传输的所有数据，低级保护包括对单个消息的保护或对一个消息中某个特定域的保护。

#### **认证业务**

 	用于保证通信的真实性。在单向通信的情况下，认证业务的功能是使接收者相信消息确实是由它自己所声称的那个信源发出的。在双向通信的情况下，如计算机终端和主机的连接，在连接开始时，认证服务则使通信双方都相信对方是真实的（即的确是它所声称的实体）。

#### **完整性业务**

 	和保密业务一样，完整性业务也能应用于消息流、单个消息或一个消息的某一选定域。用于消息流的完整性业务目的在于保证所接收的消息未经复制、插入、篡改、重排或重放，因而是和所发出的消息完全一样的。

#### **不可否认业务**

 	用于防止通信双方中的某一方对所传输消息的否认，因此，一个消息发出后，接收者能够证明这一消息的确是由通信的另一方发出的。类似地，当一个消息被接收后，发出者能够证明这一消息的确已被通信的另一方接收了。

#### 访问控制

  	访问控制的目标是防止对网络资源的非授权访问，控制的实现方式是认证，即检查欲访问某一资源的用户是否具有访问权。

## 1.2 信息安全模型

​	通信双方欲传递某个消息，需通过以下方式建立一个逻辑上的信息通道：首先在网络中定义从发方到收方的一个路由，然后在该路由上共同执行通信协议。

![image-20241107210527761](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107210527761.png)

[^图1.2]: 信息安全基本模型如

​	如果需要保护所传信息以防敌手对其保密性、认证性等构成的威胁，则需要考虑通信的安全性。安全传输技术有以下两个基本成份：

1. ​	消息的安全传输：包括对消息的加密和认证。加密的目的是将消息搞乱以使敌手无法读懂，认证的目的是检查发送者的身份。
2. ​	通信双方共享的某些秘密信息，如加密密钥。

​	安全的网络通信必须考虑以下4个方面：

1. 加密算法
2. 用于加密算法的秘密信息
3. 秘密信息的分布和共享
4. 使用加密算法和秘密信息以获得安全服务所需的协议

​	对付未授权访问的安全机制可分为两道防线，第一道称为守卫者，它包括基于通行字的登录程序和屏蔽逻辑程序，分别用于拒绝非授权用户的访问、检测和拒绝病毒。第二道防线由一些内部控制部件构成，用于管理系统内部的各项操作和分析所存有的信息，以检查是否有未授权的入侵者。下图表示保护信息系统以防未授权访问的一个模型。

![image-20241107210847438](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107210847438.png)

[^图 1.3]: 保护信息系统以防未授权访问模型

#### 小结

​	上面我们介绍了信息安全面临的威胁以及信息安全的一般模型。信息安全又分为系统安全（包括操作系统的安全、数据库系统的安全等）、数据安全（包括数据的安全存储、安全传输）和内容安全（包括病毒的防护、不良内容的过滤等）三个层次，是一个综合、交叉的学科领域，要利用数学、电子、信息、通信、计算机等诸多学科的长期知识积累和最新发展成果。信息安全研究的内容很多，它涉及安全体系结构、安全协议、密码理论、信息分析、安全监控、应急处理等，其中密码技术是保障数据安全的关键技术。

## 1.3 密码学基本概念

### 1.3.1 保密通信系统

密码系统主要包括以下几个基本要素：明文，密文，加密算法，解密算法和密钥。

- **明文**：发送方即将要发送的消息。
- **密文**：明文经过密码变换后的消息。
- **加密**：由明文变换为密文的过程。
- **解密**：由密文恢复出原明文的过程。
- **加密算法**：对明文进行加密时所采用的一组规则。
- **解密算法**：对密文进行解密时所采用的一组规则。
- **密钥**：是一种特定的值，能使密码算法按照指定的方式进行，并产生相应的密文，密钥是密码体制安全保密的关键。

密码系统中的一些基本术语：

- **加密员（密码员）**：对明文进行加密操作的人员。
- **接收者**：传送消息的预定对象。
- **截收者**：在信息传输和处理系统中，通过搭线窃听、电磁窃听、声音窃听等方式来窃取机密信息。
- **加密密钥和解密密钥**：加密算法和解密算法的操作通常都是在一组密钥控制下进行。
- **单钥密码体制（对称密码体制）**：传统密码体制所用的加密密钥和解密密钥相同，或实质上等同，即从一个易于得出另一个。
- **双钥密码体制（非对称密码体制**）：若是加密密钥和解密密钥不相同，即从一个难于推出另一个



通信双方采用保密通信系统可以**隐蔽**和**保护**需要发送的消息，使未授权者不能提取信息。

![image-20241107211229344](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107211229344.png)

[^图1-5]: 保密通信系统模型

> 明文消息空间*M*，
>
> 密文消息空间*C*，
>
> 密钥空间*K*1和*K*2，在单钥体制下*K*1=*K*2=*K*，此时密钥K需经安全的密钥信道由发送方传给接收方；
>
> 加密变换*E*k1：*M→C*，其中*k*1∈*K*1，由加密器完成；
>
> 解密变换*D*k2：*C→M*，其中*k*2∈*K*2，由解密器实现

  ![image-20241107211555239](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107211555239.png)

![image-20241107211614761](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107211614761.png)

![image-20241107211630166](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107211630166.png)

为了保护信息的保密性，抗击密码分析，保密系统应当满足下述要求：

1. 系统即使达不到理论上是不可破的，即 ，也应当为实际上不可破的。就是说，从截获的密文或某些已知明文密文对，要决定密钥或任意明文在计算上是不可行的。
2. 系统的保密性不依赖于对加密体制或算法的保密，而依赖于密钥。这是著名的 Kerckhoff原则。
3. 加密和解密算法适用于密钥空间中的所有元素。
4. 系统便于实现和使用。

### 1.3.2 密码体制分类

密码体制从原理上分为**单钥体制**和**双钥体制**两大类。

#### **单钥体制（对称秘钥体制）**

1. 单钥体制的加密密钥和解密密钥相同。
2. 单钥体制有很高的保密性，很强的安全性，根据这种特性，单钥加解密算法可通过低费用的芯片来实现。
3. 单钥体制不仅可用于数据加密，也用于消息的认证

**单钥体制**对明文消息的加密有两种方式：

1. **流密码**：对明文消息按字符(如二元数字)逐位地进行加密。
2. **分组密码**：将明文消息分组(含有多个字符)，逐组地进行加密。

#### **双钥体制（非对称秘钥体制、公钥体制）**

  双钥体制又称作**公钥体制**。采用双钥体制的每个用户都有一对选定的密钥：一个是可以公开的，可以像电话号码一样进行注册公布；另一个则是秘密的。  

  双钥密码体制的特点：**将加密和解密能力分开**

1. 可以实现多个用户加密的消息只能由一个用户解读，可用于公共网络中实现保密通信。
2. 由一个用户加密的消息而使多个用户可以解读，可用于实现对用户的认证。

#### **密钥管理**

1. 主要包括密钥产生、分配、存储、销毁等问题。
2. 密钥管理是影响系统安全的关键因素，即使密码算法再好，若密钥管理问题处理不好，就很难保证系统的安全保密。



### 1.3.3 密码攻击概述

  表1-1是攻击者对密码系统的四种攻击类型，类型的划分由攻击者可获取的信息量决定。

   最困难的攻击是唯密文攻击，密文攻击时，敌手知道的信息量最少，因此最易抵抗。

![image-20241107212032164](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212032164.png)

**已知明文攻击**：敌手可能有更多的信息，也许能截获一个或多个明文及其对应的密文，也许知道消息中将出现的某种明文格式，敌手也许能够从已知的明文被变换成密文的方式得到密钥。

**可能字攻击**：敌手可能对消息含义知之甚少，如果对非常特别的信息加密，敌手也许能知道消息中的某一部分。

**选择密文攻击**：攻击者利用解密算法，对自己所选的密文解密出相应的明文，如果攻击者能在加密系统中插入自己选择的明文消息，则通过该明文消息对应的密文，有可能确定出密钥的结构。

**注意两个概念：**

1. 一个加密算法是无条件安全的，如果算法产生的密文不能给出惟一决定相应明文的足够信息。此时无论敌手截获多少密文、花费多少时间，都不能解密密文。
2. Shannon指出，仅当密钥至少和明文一样长时，才能达到无条件安全。也就是说除了一次一密方案外，再无其他的加密方案是无条件安全的。

比无条件安全弱的一个概念是**计算上安全的**，加密算法只要满足以下两条准则之一就称为是计算上安全的：

1. 破译密文的代价超过被加密信息的价值。
2. 破译密文所花的时间超过信息的有用期。

## 1.4 几种古典密码

​     古典密码的加密是将明文的每一字母代换为字母表中的另一字母，代换前首先将明文字母用等价的十进制数字代替，再以代替后的十进制数字进行运算，字母与十进制数字的对应关系如表所示。

![image-20241107212239464](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212239464.png)

​	根据代换是对每个字母逐个进行还是对多个字母同时进行，古典密码又分为单表代换密码和多表代换密码。

### 1.4.1 单表代换密码

#### **1.恺撒密码**

凯撒（Caesar)密码的加密代换和解密代换分别为：

​     ![image-20241107212317913](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212317913.png)

其中3是加解密所用的密钥，加密时，每个字母向后移3位（循环移位，字母x移到a，y移到b，z移到c）。解密时，每个字母向前移3位（循环移位）。

#### **2.移位变换**

 移位变换的加解密分别是：

![image-20241107212322186](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212322186.png)

### **3仿射变换**

仿射变换的加解密分别是：

![image-20241107212407180](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212407180.png)

其中a,b是密钥，为满足![image-20241107212432628](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212432628.png) 和<img src="/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212446034.png" alt="image-20241107212446034" style="zoom:80%;" />的整数。其中<img src="/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212507132.png" alt="image-20241107212507132" style="zoom:80%;" />表示a和26的最大公因子,表示a和26是互素的a-1表示a的逆元，即    <img src="/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212516031.png" alt="image-20241107212516031" style="zoom:80%;" />。

【例1-1】设仿射变换的加解密分别是：

![image-20241107212531441](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212531441.png)

对 “security”加密，对 “vlxijh”解密。

解:

![image-20241107212632494](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212632494.png)

所以，“security”对应的密文是 “rxjfkzyh”。

![image-20241107212647623](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212647623.png)

所以，“vlxijh”对应的明文是 “agency”。

### 1.4.2 多表代换密码

![image-20241107212711317](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212711317.png)

![image-20241107212737424](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212737424.png)

![image-20241107212751714](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212751714.png)

![image-20241107212802154](/assets/blog_res/2024-11-07-cryptology-.assets/image-20241107212802154.png)

# 第三章	分组密码体制

